package com.osthus.casis.index;

import static org.junit.Assert.*;

import java.text.Normalizer;

import org.apache.commons.lang.StringEscapeUtils;
import org.junit.Test;

import com.osthus.casis.index.ioc.ElasticSearchIocModule;

import de.osthus.ambeth.testutil.AbstractIocTest;
import de.osthus.ambeth.testutil.TestFrameworkModule;

@TestFrameworkModule(value=ElasticSearchIocModule.class)
public class EscapseUtilTest extends AbstractIocTest{

	
	@Test
	public void learnEscapeJavaScript() {
		String XMLString= "{\"DOCUMENT_COMPLETETEXT\": \r\n" + 
				"              \"<Document><CASIS-DOCNO>PD024115</CASIS-DOCNO><CASIS-UPD>20140326</CASIS-UPD><SO>T&amp;F Informa UK Ltd, London</SO><CASIS-CN><DrugNameData><DrugName isPrimaryDrugName=\\\"false\\\">hepatitis-C inhibs, Idenix</DrugName><DrugName isPrimaryDrugName=\\\"false\\\">NM-106</DrugName><DrugName isPrimaryDrugName=\\\"false\\\">NM-283</DrugName><DrugName isPrimaryDrugName=\\\"false\\\">NM283</DrugName><DrugName isPrimaryDrugName=\\\"false\\\">NMC-283</DrugName><DrugName isPrimaryDrugName=\\\"false\\\">NV-08, Idenix</DrugName><DrugName isPrimaryDrugName=\\\"false\\\">valopicitabine</DrugName><DrugName isPrimaryDrugName=\\\"true\\\">valopicitabine dihydrochloride</DrugName></DrugNameData><ChemicalName>2'C-Methylcytidine-3'-O-L-valine ester</ChemicalName></CASIS-CN><CASIS-RN><CASNumber>640725-71-9</CASNumber></CASIS-RN><NCE>Yes</NCE><Origin>Chemical, synthetic</Origin><MF>C15H26Cl2N4O6</MF><MW>429.30</MW><CASIS-TX><Overview>Idenix (formerly Novirio) has discontinued development of valopicitabine dihydrochloride (NMC-283), the lead in a series of anti-hepatitis-C virus (HCV) compounds (NV-08), following an FDA risk-benefit profile analysis (Press release, Novartis, 17 Jul 2007; Form 20-F, Novartis, 2007). It is a nucleoside analogue that inhibits flavivirus polymerases, and is a valine ester prodrug of NM-107 (qv), an earlier lead in the series, with improved oral bioavailability (Scrip Daily Online, 22 Nov 1999; Direct communication, Idenix, 4 Dec 2002). It targets the NS5B subunit of HCV RNA polymerase (Digestive Dis Wk (New Orleans), 2004).</Overview><Marketing>Novartis exercised an option for joint development of valopicitabine dihydrochloride with Idenix. Idenix and Novartis were to co-promote the compound in France, Germany, Italy, Spain, the UK and the US (Press release, Novartis, 29 Mar 2006).</Marketing><Licensing>Valopicitabine dihydrochloride was available for licensing worldwide (Direct communication, Novirio, 7 Aug 2001).</Licensing><KeyClinicalInformation><PhaseIII>Phase III trials in Europe and the US in 1000-1200 HCV-1 patients who had failed on pegylated interferon or ribavirin (qv) therapy were planned. Valopicitabine dihydrochloride + Pegasys (qv) was to be compared to valopicitabine dihydrochloride + ribavirin. A Phase III trial in HCV and HIV co-infected patients was also planned.</PhaseIII><PhaseII>Clinical trials were placed on hold for evaluation of the risk-benefit profile (Press release, Novartis, 17 Jul 2007). It was in a drug interaction study with ribavirin in 90 treatment-naive patients (JP Morgan 25th Ann Healthcare Conf (San Francisco), 2007). In a 6mth US Phase IIb trial, comparing the Pegasys combination with Pegasys + ribavirin and with valopicitabine dihydrochloride monotherapy in 178 treatment-failed HCV genotype 1 patients, no patients treated with valopicitabine hydrochloride + Pegasys achieved a sustained viral response (SVR), cf 1 patient retreated with Pegasys + ribavirin (primary endpoint), though 42% (10/24) of prior partial responders on valopicitabine dihydrochloride + Pegasys achieved PCR negativity at the end of treatment, as did 16% (19/120) of prior null responders. There were 31 discontinuations due to adverse events, of which 12 were GI-related, but no discontinuations attributable to valopicitabine dihydrochloride were recorded after the dosage was amended to 400mg/day (JP Morgan 24th Ann Healthcare Conf (San Francisco), 2006; Press release, Idenix, 12 Apr 2007). In a US 48wk Phase IIb trial in 173 treatment-naive HCV patients, receiving Pegasys 180ï¿¿g/wk on day 8 + valopicitabine dihydrochloride once-daily 200mg on day 1, 400-800mg on days 29-32, 400-800mg on days 1-6, 800mg on day 1, or Pegasys 180ï¿¿g/wk + valopicitabine dihydrochloride 800mg once-daily both on day 1, 53% (18/34) of patients on valopicitabine dihydrochloride 200mg/day + Pegasys achieved undetectable HCV levels (&lt;20IU/ml) at 48wk (primary endpoint). There were 38 discontinuations due to adverse events, mostly GI-related, though no serious events attributable to valopicitabine dihydrochloride were observed following reduction of the dosage to 200-400mg/day (JP Morgan 24th Ann Healthcare Conf (San Francisco), 2006; Press release, Idenix, 12 Apr 2007). In an open-label Phase IIa trial in 30 treatment-naive HCV patients, interim data from 19 patients showed a mean viral load reduction of 3.2log copies/ml in patients receiving valopicitabine dihydrochloride po once-daily x24wk escalating to 800mg/day + Pegasys 1.0ï¿¿g/kg q wk starting on day 8, cf a decline of 1log copies/ml on valopicitabine dihydrochloride alone. On the combination therapy, 9/12 evaluable patients had an early virologic response (EVR) at 28 days (Press release, Idenix, 24 Feb 2005; 12th Ann NewsMakers BioTech Industry (New York), 2005). In a dose-escalation Phase I/II trial in patients with HCV-1, valopicitabine dihydrochloride 50-800mg/day po was rapidly absorbed and converted to NM-107 and a minor metabolite, NM-106. NM-106 was only transiently detected at doses of 50 and 100mg, increasing with repeat-dosing and higher doses, with a t1/2 of 12hr. Valopicitabine dihydrochloride 50-800mg/day had a t1/2, Tmax, Cmax and AUC of 4.4-4.6hr, 2.2-3.6hr, 0.43-4.33\\\\ug/ml and 3.3-38.9\\\\ughr/ml, respectively. It resulted in dose-related serum HCV RNA viral load reductions of 0.15-1.21log (40th Meet Eur Assoc Study Liver (Paris), 2005, Abs, 626).</PhaseII><PhaseI>In a proof-of-concept, dose-escalation, placebo-controlled, US Phase I trial in 95 non-cirrhotic, HCV genotype 1 patients, valopicitabine dihydrochloride 50-800mg/day po x15 days resulted in a 70% decrease in viral load in all patients, with a 92% decrease in the 400-800mg escalating cohort, and a 94% decrease on 800mg. Of these patients, 87% had failed previous interferon + ribavirin therapy. It had linear pharmacokinetics up to 400mg/day with AUC and Cmax increasing with dose. There were no serious adverse events, DLTs, or grade 3-4 abnormalities. The most frequent adverse event was transient nausea and vomiting which occurred at doses &gt;400mg (Digestive Dis Wk (New Orleans), 2004; Press release, Idenix, 1 Nov 2004).</PhaseI><Preclinical>In a primate model of human-derived chronic HCV infection, valopicitabine dihydrochloride 8.3 or 16.6mg/kg po once-daily x1wk gave a mean viral load reduction at day 7 of 0.83 and 1.05log, respectively; however, HCV titres were stable in the pretreatment and placebo samples (Press release, Idenix, 9 Apr 2003). In vitro, valopicitabine dihydrochloride + boceprevir (qv) gave additive antiviral activity cf either agent alone, with no cross-resistance, and the combination significantly reduced the frequency of resistant colonies cf each agent alone (Press release, Idenix, 12 Apr 2007).</Preclinical></KeyClinicalInformation></CASIS-TX><LatestChangeDate>20100126</LatestChangeDate><LatestChange>Deconsolidation of Idenix from Novartis reported</LatestChange><CASIS-RDAT><KeyEvent>20080204 Discontinued Products:Phase II Clinical Trial, Unspecified</KeyEvent><KeyEvent>20070717 Suspended Products:Phase II Clinical Trial</KeyEvent><KeyEvent>20050125 New Chemical Structure:New</KeyEvent><KeyEvent>20050120 Names Granted:NM-283</KeyEvent><KeyEvent>20030121 Mechanism Identified:RNA-directed RNA polymerase inhibitor (PO-RRNA-)</KeyEvent><KeyEvent>20030121 Change in Global Status:Phase I/II Clinical Trial</KeyEvent><KeyEvent>20020107 Compounds Identified:NV-08</KeyEvent><KeyEvent>20010807 Licensing Opportunities:Worldwide</KeyEvent><KeyEvent>20010604 Compounds Identified:hepatitis-C inhibs, Novirio</KeyEvent><KeyEvent>19991201 New Product</KeyEvent></CASIS-RDAT><CASIS-DSTA><Country>World: Discontinued</Country><Country>AR: Licensing Availability: Yes</Country><Country>AU: Licensing Availability: Yes</Country><Country>AT: Licensing Availability: Yes</Country><Country>BE: Licensing Availability: Yes</Country><Country>BR: Licensing Availability: Yes</Country><Country>CA: Licensing Availability: Yes</Country><Country>CL: Licensing Availability: Yes</Country><Country>CN: Licensing Availability: Yes</Country><Country>CO: Licensing Availability: Yes</Country><Country>DK: Licensing Availability: Yes</Country><Country>SF: Licensing Availability: Yes</Country><Country>FR: Licensing Availability: Yes</Country><Country>DE: Licensing Availability: Yes</Country><Country>GR: Licensing Availability: Yes</Country><Country>HK: Licensing Availability: Yes</Country><Country>IN: Licensing Availability: Yes</Country><Country>IE: Licensing Availability: Yes</Country><Country>IL: Licensing Availability: Yes</Country><Country>IT: Licensing Availability: Yes</Country><Country>JP: Licensing Availability: Yes</Country><Country>LU: Licensing Availability: Yes</Country><Country>MY: Licensing Availability: Yes</Country><Country>MX: Licensing Availability: Yes</Country><Country>NL: Licensing Availability: Yes</Country><Country>NZ: Licensing Availability: Yes</Country><Country>NO: Licensing Availability: Yes</Country><Country>PE: Licensing Availability: Yes</Country><Country>PH: Licensing Availability: Yes</Country><Country>PT: Licensing Availability: Yes</Country><Country>RU: Licensing Availability: Yes</Country><Country>ZA: Licensing Availability: Yes</Country><Country>KR: Licensing Availability: Yes</Country><Country>ES: Licensing Availability: Yes</Country><Country>SE: Licensing Availability: Yes</Country><Country>CH: Licensing Availability: Yes</Country><Country>TH: Licensing Availability: Yes</Country><Country>TR: Licensing Availability: Yes</Country><Country>UK: Licensing Availability: Yes</Country><Country>US: Phase II Clinical Trial; Licensing Availability: Yes</Country><Country>VE: Licensing Availability: Yes</Country></CASIS-DSTA><CASIS-CO><Company>Originator: Idenix: Discontinued</Company><Company>Licensee: Novartis: Discontinued</Company></CASIS-CO><CASIS-LN><LN>Antiviral, other:Discontinued</LN></CASIS-LN><CASIS-USE><CASIS-ACT><ACT>Antiviral, other</ACT></CASIS-ACT><CASIS-MA><MA>HCV-NS5B polymerase inhibitor</MA></CASIS-MA><CASIS-IND><IND>Infection, hepatitis-C virus::Discontinued</IND></CASIS-IND></CASIS-USE><DeliveryData><DeliveryRouteData><DeliveryRoute>Oral</DeliveryRoute><DeliveryRoute>Oral, swallowed</DeliveryRoute></DeliveryRouteData></DeliveryData><TargetData><Targets><Target><TargetName>polyprotein, hepatitis-C virus</TargetName><EntrezGeneID>951475</EntrezGeneID><TargetTarget><TargetTargetFamilies><TargetTargetFamily>Enzyme &gt; Polymerase</TargetTargetFamily><TargetTargetFamily>Enzyme &gt; Protease/peptidase</TargetTargetFamily></TargetTargetFamilies></TargetTarget></Target></Targets></TargetData><PharmacokineticData><Pharmacokinetic><Model>Human (50-800mg/day po)</Model><Parameters><Parameter>AUC - 3.3 - 38.9ï¿¿ghr/ml</Parameter><Parameter>Cmax - 0.43 - 4.33ï¿¿g/ml</Parameter><Parameter>t1/2 - 4.48hr</Parameter><Parameter>Tmax - 2.2 - 3.6hr</Parameter></Parameters></Pharmacokinetic></PharmacokineticData><DrugURL>http://bayer-pipeline.citeline.com/CpViewAccess.aspx?B=24115&amp;C=0&amp;D=9</DrugURL><CASIS-MDNUMBER>MD359467    </CASIS-MDNUMBER></Document>\"}";
		
		XMLString="'1";
		System.out.println(XMLString);
		System.out.println(StringEscapeUtils.escapeJavaScript(XMLString));
		
		
//		String testStr = "< > \" &"; 
//		System.out.println("Escaped : " + StringEscapeUtils.escapeJava(testStr)); 
//		
//		String subjectString = "öäü";
//		subjectString = "検索 • Busca • Sök • 搜尋 • Tìm kiếm • Пошук • Cerca • Søk • Haku • Hledání • Keresés • 찾기 • Cari • Ara • جستجو • Căutare • بحث • Hľadať • Søg • Serĉu • Претрага • Paieška • Poišči • Cari • חיפוש • Търсене • Іздеу • Bilatu • Suk • Bilnga • Traži • खोजें";
//		
//		subjectString = Normalizer.normalize(subjectString, Normalizer.Form.NFD);
//		String resultString = subjectString.replaceAll("[^\\x00-\\x7F]", "");
//		System.out.println(resultString);
	}

}
