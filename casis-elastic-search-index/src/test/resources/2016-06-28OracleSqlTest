
-- test for function -- queryLastTsFromCasisTableAndPreviousRunTable


--Newest table
SELECT MAX(UPDATE_TIMESTAMP)as UPDATE_TIMESTAMP  FROM 
(
SELECT MAX(UPDATE_TIMESTAMP)as UPDATE_TIMESTAMP FROM CASIS_DOCUMENT
UNION
SELECT MAX(UPDATE_TIMESTAMP)as UPDATE_TIMESTAMP FROM CASIS_COMPANY
UNION
SELECT MAX(UPDATE_TIMESTAMP)as UPDATE_TIMESTAMP FROM CASIS_COMPOUND
UNION
SELECT MAX(UPDATE_TIMESTAMP) as UPDATE_TIMESTAMP FROM CASIS_USE
UNION
SELECT MAX(UPDATE_TIMESTAMP)as UPDATE_TIMESTAMP FROM CASIS_DEVSTATUS
UNION
SELECT MAX(UPDATE_TIMESTAMP)AS UPDATE_TIMESTAMP FROM DOC_STRUC_LINK
);

--newest runs-table
SELECT * FROM CASIS2_BG_INGEST_RUNS2
WHERE END_TS = (SELECT MAX(END_TS)AS END_TS FROM CASIS2_BG_INGEST_RUNS2);
