--CASIS_RCG_MOLTABLE add and undo process
--
----add columns
---- add ID
ALTER TABLE casis_mgr.CASIS_RCG_MOLTABLE ADD(ID NUMBER (18,0)); 
CREATE SEQUENCE "CASIS_RCG_MOLTABLE_SEQU"  MINVALUE 1 MAXVALUE 999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 100 NOORDER NOCYCLE ;
UPDATE CASIS_MGR.CASIS_RCG_MOLTABLE SET ID=CASIS_RCG_MOLTABLE_SEQU.NEXTVAL;
ALTER TABLE CASIS_MGR.CASIS_RCG_MOLTABLE ADD CONSTRAINT PK_CASIS_RCG_MOLTABLE PRIMARY KEY (ID);
-- add version
ALTER TABLE CASIS_MGR.CASIS_RCG_MOLTABLE ADD(VERSION NUMBER (9,0));
UPDATE CASIS_MGR.CASIS_RCG_MOLTABLE SET VERSION=1;
-- add time_stamp
ALTER TABLE CASIS_MGR.CASIS_RCG_MOLTABLE ADD(UPDATE_TIMESTAMP TIMESTAMP(3));
UPDATE CASIS_MGR.CASIS_RCG_MOLTABLE SET UPDATE_TIMESTAMP=SYSDATE; 


--------add trigger:
--create or replace 
--TRIGGER CASIS_RCG_MOLTABLE
--BEFORE INSERT OR UPDATE OR DELETE 
--ON CASIS_RCG_MOLTABLE
--REFERENCING NEW AS NEW OLD AS OLD FOR EACH ROW
--BEGIN
--    IF INSERTING then
--         SELECT CASIS_DOCUMENT_SEQU.NEXTVAL INTO :NEW.ID FROM DUAL;
--        :NEW.Version := 1;
--        :NEW.UPDATE_TIMESTAMP := SYSDATE;
--    ELSIF UPDATING then
--        :NEW.Version := :OLD.Version +1;
--    ELSE
--        NULL;
--    END IF;
--    EXCEPTION
--      WHEN OTHERS THEN
--        NULL;
--END;


----test Insert 
--Insert into CASIS_RCG_MOLTABLE (SRC_DB) values ('DGL');
------ test update
--UPDATE CASIS_RCG_MOLTABLE SET ID = ID +1 WHERE SRC_DB='DGL';
------Display
--SELECT * FROM CASIS_RCG_MOLTABLE;
----count
--SELECT COUNT(*) FROM CASIS_RCG_MOLTABLE;
----delete the row
--DELETE FROM CASIS_RCG_MOLTABLE WHERE DOCNO='1111111';

